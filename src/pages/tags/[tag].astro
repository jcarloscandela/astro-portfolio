---
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  const allPosts = await getCollection("posts");
  const tags = new Set(
    allPosts.flatMap((post) => post.data.tags || [])
  );

  return Array.from(tags).map((tag) => ({
    params: { tag },
  }));
}
import PostCard from "../../components/PostCard.astro";

const { tag } = Astro.params;
const allPosts = await getCollection("posts", ({ data }) => !data.draft);
const filteredPosts = allPosts.filter((post) =>
  post.data.tags && post.data.tags.includes(tag)
);
---

<h1 class="text-3xl font-bold mb-6">Posts tagged "{tag}"</h1>
{filteredPosts.length === 0 ? (
  <p>No posts found for this tag.</p>
) : (
  <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
    {filteredPosts.map((post) => (
      <PostCard post={post} />
    ))}
  </div>
)}
